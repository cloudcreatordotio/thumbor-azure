# Azure Web App Environment Variables for Thumbor Container
# Copy these to your Azure Web App Configuration -> Application Settings

# Security Settings
SECURITY_KEY=CHANGE_THIS_TO_A_SECURE_RANDOM_KEY_IN_PRODUCTION
ALLOW_UNSAFE_URL=False

# Thumbor Process Configuration
THUMBOR_NUM_PROCESSES=4

# CORS Configuration
CORS_ALLOW_ORIGIN=*

# Image Format Settings
AUTO_WEBP=True
AUTO_PNG_TO_JPG=False
WEBP_QUALITY=80
QUALITY=80

# HTTP Loader Settings
HTTP_LOADER_FORWARD_USER_AGENT=True
HTTP_LOADER_TIMEOUT=60
HTTP_LOADER_MAX_REDIRECTS=5

# Cache Configuration (Nginx proxy cache)
THUMBOR_PROXY_CACHE_SIZE=100g
THUMBOR_PROXY_CACHE_MEMORY_SIZE=1024m
THUMBOR_PROXY_CACHE_INACTIVE=512m
THUMBOR_PROXY_CACHE_DURATION=1m

# Storage Settings
STORAGE_EXPIRATION_SECONDS=2592000
RESULT_STORAGE_EXPIRATION_SECONDS=0

# Upload Settings
UPLOAD_MAX_SIZE=104857600
UPLOAD_ENABLED=True
UPLOAD_DELETE_ALLOWED=False

# Image Processing Limits
MAX_WIDTH=3000
MAX_HEIGHT=3000
MIN_WIDTH=1
MIN_HEIGHT=1

# Performance Settings
ENGINE_THREADPOOL_SIZE=10
HTTP_LOADER_MAX_CONN_PER_HOST=30
SLOW_REQUEST_TIME_SECONDS=10

# Error Tracking (Optional)
SENTRY_DSN_URL=

# Azure Specific Settings
ENABLE_SSH=false

# Allowed Sources Pattern
# Note: In Azure Web App, set this as a single line string
# ALLOWED_SOURCES=['.+\.mywebsite\.com', 'mywebsite2\.blob\.core\.windows\.net', '(.*)\\.?mywebsite3\.com']

# Host Mappings (Optional - handle via DNS or Azure Private Endpoints instead)
# These were previously handled by docker extra_hosts
# Consider using Azure Private Endpoints or DNS configuration for internal routing

# Redis Settings (Internal - not configurable as Redis runs inside container)
# REDIS_SERVER_HOST=localhost
# REDIS_SERVER_PORT=6379
# REDIS_SERVER_DB=0

# Logging Level
LOG_LEVEL=INFO

# Metrics
METRICS_ENABLED=True

# Feature Flags
PRESERVE_EXIF_INFO=True
RESPECT_ORIENTATION=True
PROGRESSIVE_JPEG=True
ENABLE_ETAGS=True
SEND_IF_MODIFIED_LAST_MODIFIED_HEADERS=True

# Detection Settings
USE_FACE_DETECTION=True
USE_FEATURE_DETECTION=True
USE_QUEUED_DETECTOR=True

# Optimizer Settings
JPEGTRAN_PROGRESSIVE=True
OPTIPNG_LEVEL=5
AUTO_PNG_TO_JPG_ALPHA=255

# GIF Settings
USE_GIFSICLE_ENGINE=True
FFMPEG_GIF_AUTO_H264=True

# Azure Web App Settings Notes:
# 1. PORT environment variable is automatically set by Azure
# 2. Use Azure Storage Mount for persistent cache if needed
# 3. Configure custom domain and SSL in Azure Portal
# 4. Use Azure Application Insights for monitoring
# 5. Set up Azure CDN in front of Web App for better performance
# 6. Configure autoscaling rules based on your traffic patterns
# 7. Use deployment slots for zero-downtime deployments
